require 'test_helper'

describe ServiceHelper::OptimizationResultPresenter do
  
  before do
    output = '{"default_output_results_name":{"1030":{"operator":1030,"tarif_sets":{"203":{"all-world-rouming/sms":{"203":[203]},"own-country-rouming/mobile-connection":{"203_283":[203,283],"203":[203]},"own-country-rouming/sms":{"203":[203]},"own-country-rouming/mms":{"203":[203]},"all-world-rouming/mms":{"203":[203]},"own-country-rouming/calls":{"203_283":[203,283],"203":[203]},"periodic":{"203_283":[203,283],"203":[203]},"onetime":{"203_283":[203,283],"203":[203]}},"200":{"all-world-rouming/sms":{"200":[200]},"own-country-rouming/sms":{"200":[200]},"own-country-rouming/mms":{"200":[200]},"all-world-rouming/mms":{"200":[200]},"own-country-rouming/mobile-connection":{"200":[200]},"own-country-rouming/calls":{"200":[200]},"periodic":{"200":[200]},"onetime":{"200":[200]}}},"tarif_results":{"283":{"own-country-rouming/mobile-connection":{},"own-country-rouming/calls":{},"periodic":{},"onetime":{}},"203":{"all-world-rouming/sms":{},"own-country-rouming/mobile-connection":{"203":{"part":"own-country-rouming/mobile-connection","tarif_class_id":203,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4565,4570,4575,4579,4583,4588,4592,4597,4601,4605,4610],"price_value":0.0,"call_id_count":"28.0","price_values":[{"tarif_class_id":203,"service_category_group_id":76,"service_category_tarif_class_id":-1,"service_category_name":"scg_mts_smart_plus_included_in_tarif_internet","month":1,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4565,4570,4575,4579,4583,4588,4592,4597,4601,4605,4610],"call_id_count":28,"price_formula_id":1605,"price_value":0,"all_stat":{"month":1,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4565,4570,4575,4579,4583,4588,4592,4597,4601,4605,4610],"call_id_count":28,"sum_volume":1122}}],"set_id":"203","id":null}},"own-country-rouming/sms":{"203":{"part":"own-country-rouming/sms","tarif_class_id":203,"call_ids":[4480,4550,4492,4496,4505,4510,4514,4523,4532,4541,4572,4577,4581,4585,4590,4594,4599,4603,4607,4519,4537,4558,4484,4500,4528,4546,4554,4562,4567],"price_value":10.5,"call_id_count":"29.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1871,"service_category_name":"_sctcg_all_world_sms_incoming","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1620,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_volume":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1864,"service_category_name":"_sctcg_own_home_regions_sms_to_not_own_country","month":1,"call_ids":[4480,4550],"call_id_count":2,"price_formula_id":1623,"price_value":10.5,"all_stat":{"month":1,"call_ids":[4480,4550],"call_id_count":2,"count_volume":2}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1863,"service_category_name":"_sctcg_own_home_regions_sms_to_own_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1622,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_volume":0}},{"tarif_class_id":203,"service_category_group_id":75,"service_category_tarif_class_id":-1,"service_category_name":"scg_mts_smart_plus_included_in_tarif_sms","month":1,"call_ids":[4492,4496,4505,4510,4514,4523,4532,4541,4572,4577,4581,4585,4590,4594,4599,4603,4607],"call_id_count":17,"price_formula_id":1604,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4492,4496,4505,4510,4514,4523,4532,4541,4572,4577,4581,4585,4590,4594,4599,4603,4607],"call_id_count":17,"count_volume":17}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1870,"service_category_name":"own_country_sms_incoming","month":1,"call_ids":[4519,4537,4558],"call_id_count":3,"price_formula_id":1620,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4519,4537,4558],"call_id_count":3,"count_volume":3}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1860,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4484,4500,4528,4546,4554,4562,4567],"call_id_count":7,"price_formula_id":1620,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4484,4500,4528,4546,4554,4562,4567],"call_id_count":7,"count_volume":7}}],"set_id":"203","id":null}},"own-country-rouming/mms":{"203":{"part":"own-country-rouming/mms","tarif_class_id":203,"call_ids":[4485,4488,4489,4506,4507,4516,4520,4525,4534,4543,4551,4555,4568,4569,4573,4578,4587,4591,4604,4608,4609,4481,4497,4501,4502,4515,4524,4529,4533,4538,4542,4559,4563,4564,4574,4586,4595,4596,4600,4533,4533],"price_value":123.5,"call_id_count":"41.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1846,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4485,4488,4489,4506,4507,4516,4520,4525,4534,4543,4551,4555,4568,4569,4573,4578,4587,4591,4604,4608,4609],"call_id_count":21,"price_formula_id":1608,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4485,4488,4489,4506,4507,4516,4520,4525,4534,4543,4551,4555,4568,4569,4573,4578,4587,4591,4604,4608,4609],"call_id_count":21,"count_volume":21}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1847,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4481,4497,4501,4502,4515,4524,4529,4533,4538,4542,4559,4563,4564,4574,4586,4595,4596,4600],"call_id_count":18,"price_formula_id":1609,"price_value":117.0,"all_stat":{"month":1,"call_ids":[4481,4497,4501,4502,4515,4524,4529,4533,4538,4542,4559,4563,4564,4574,4586,4595,4596,4600],"call_id_count":18,"count_volume":18}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1874,"service_category_name":"_sctcg_own_home_regions_mms_to_own_country_own_operator","month":1,"call_ids":[4533],"call_id_count":1,"price_formula_id":1627,"price_value":3.25,"all_stat":{"month":1,"call_ids":[4533],"call_id_count":1,"count_volume":1}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1875,"service_category_name":"_sctcg_own_home_regions_mms_to_own_country_own_operator","month":1,"call_ids":[4533],"call_id_count":1,"price_formula_id":1628,"price_value":3.25,"all_stat":{"month":1,"call_ids":[4533],"call_id_count":1,"count_volume":1}}],"set_id":"203","id":null}},"all-world-rouming/mms":{"203":{"part":"all-world-rouming/mms","tarif_class_id":203,"call_ids":[4511,4547,4493,4582],"price_value":13.0,"call_id_count":"4.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1848,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4511,4547],"call_id_count":2,"price_formula_id":1610,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4511,4547],"call_id_count":2,"count_volume":2}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1849,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4493,4582],"call_id_count":2,"price_formula_id":1611,"price_value":13.0,"all_stat":{"month":1,"call_ids":[4493,4582],"call_id_count":2,"count_volume":2}}],"set_id":"203","id":null}},"own-country-rouming/calls":{"203":{"part":"own-country-rouming/calls","tarif_class_id":203,"call_ids":[4487,4495,4504,4513,4518,4553,4557,4576,4580,4589,4598,4602,4606,4522,4561,4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"price_value":770.0,"call_id_count":"25.0","price_values":[{"tarif_class_id":203,"service_category_group_id":74,"service_category_tarif_class_id":-1,"service_category_name":"scg_mts_smart_plus_included_in_tarif_calls","month":1,"call_ids":[4487,4495,4504,4513,4518,4553,4557,4576,4580,4589,4598,4602,4606],"call_id_count":13,"price_formula_id":1603,"price_value":0,"all_stat":{"month":1,"call_ids":[4487,4495,4504,4513,4518,4553,4557,4576,4580,4589,4598,4602,4606],"call_id_count":13,"sum_duration_minute":104}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1869,"service_category_name":"own_country_calls_other_countries","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1619,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1859,"service_category_name":"_sctcg_own_home_regions_calls_other_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1619,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1867,"service_category_name":"own_country_calls_sic_countries","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1617,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1856,"service_category_name":"_sctcg_own_home_regions_calls_to_own_country_not_own_operator","month":1,"call_ids":[4522,4561],"call_id_count":2,"price_formula_id":1616,"price_value":672,"all_stat":{"month":1,"call_ids":[4522,4561],"call_id_count":2,"sum_duration_minute":48}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1855,"service_category_name":"_sctcg_own_home_regions_calls_to_own_country_own_operator","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1615,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1857,"service_category_name":"_sctcg_own_home_regions_calls_sic_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1617,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1858,"service_category_name":"_sctcg_own_home_regions_calls_europe","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1618,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1850,"service_category_name":"_sctcg_own_home_regions_calls_incoming","month":1,"call_ids":[4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"call_id_count":10,"price_formula_id":1612,"price_value":0,"all_stat":{"month":1,"call_ids":[4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"call_id_count":10,"sum_duration_minute":138}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1868,"service_category_name":"own_country_calls_europe","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1618,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}}],"set_id":"203","id":null}},"periodic":{"203":{"part":"periodic","tarif_class_id":203,"call_ids":[],"price_value":1034.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1845,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1607,"price_value":900.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1873,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1626,"price_value":34.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1877,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1630,"price_value":100.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}}],"set_id":"203","id":null}},"onetime":{"203":{"part":"onetime","tarif_class_id":203,"call_ids":[],"price_value":34.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1844,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1606,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1872,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1625,"price_value":34.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1876,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1629,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}}],"set_id":"203","id":null}}},"203_283":{"own-country-rouming/mobile-connection":{"203":{"part":"own-country-rouming/mobile-connection","tarif_class_id":203,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4565,4570,4575,4579,4583,4588,4592,4597,4601,4605,4610],"price_value":0.0,"call_id_count":"28.0","price_values":[{"tarif_class_id":203,"service_category_group_id":76,"service_category_tarif_class_id":-1,"service_category_name":"scg_mts_smart_plus_included_in_tarif_internet","month":1,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4565,4570,4575,4579,4583,4588,4592,4597,4601,4605,4610],"call_id_count":28,"price_formula_id":1605,"price_value":0,"all_stat":{"month":1,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4565,4570,4575,4579,4583,4588,4592,4597,4601,4605,4610],"call_id_count":28,"sum_volume":1122}}],"set_id":"203_283","id":null}},"own-country-rouming/calls":{"203":{"part":"own-country-rouming/calls","tarif_class_id":203,"call_ids":[4487,4495,4504,4513,4518,4553,4557,4576,4580,4589,4598,4602,4606,4522,4561,4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"price_value":770.0,"call_id_count":"25.0","price_values":[{"tarif_class_id":203,"service_category_group_id":74,"service_category_tarif_class_id":-1,"service_category_name":"scg_mts_smart_plus_included_in_tarif_calls","month":1,"call_ids":[4487,4495,4504,4513,4518,4553,4557,4576,4580,4589,4598,4602,4606],"call_id_count":13,"price_formula_id":1603,"price_value":0,"all_stat":{"month":1,"call_ids":[4487,4495,4504,4513,4518,4553,4557,4576,4580,4589,4598,4602,4606],"call_id_count":13,"sum_duration_minute":104}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1869,"service_category_name":"own_country_calls_other_countries","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1619,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1859,"service_category_name":"_sctcg_own_home_regions_calls_other_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1619,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1867,"service_category_name":"own_country_calls_sic_countries","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1617,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1856,"service_category_name":"_sctcg_own_home_regions_calls_to_own_country_not_own_operator","month":1,"call_ids":[4522,4561],"call_id_count":2,"price_formula_id":1616,"price_value":672,"all_stat":{"month":1,"call_ids":[4522,4561],"call_id_count":2,"sum_duration_minute":48}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1855,"service_category_name":"_sctcg_own_home_regions_calls_to_own_country_own_operator","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1615,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1857,"service_category_name":"_sctcg_own_home_regions_calls_sic_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1617,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1858,"service_category_name":"_sctcg_own_home_regions_calls_europe","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1618,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1850,"service_category_name":"_sctcg_own_home_regions_calls_incoming","month":1,"call_ids":[4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"call_id_count":10,"price_formula_id":1612,"price_value":0,"all_stat":{"month":1,"call_ids":[4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"call_id_count":10,"sum_duration_minute":138}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1868,"service_category_name":"own_country_calls_europe","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1618,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}}],"set_id":"203_283","id":null}},"periodic":{"203":{"part":"periodic","tarif_class_id":203,"call_ids":[],"price_value":1034.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1845,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1607,"price_value":900.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1873,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1626,"price_value":34.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1877,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1630,"price_value":100.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}}],"set_id":"203_283","id":null}},"onetime":{"203":{"part":"onetime","tarif_class_id":203,"call_ids":[],"price_value":34.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1844,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1606,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1872,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1625,"price_value":34.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":203,"service_category_group_id":-1,"service_category_tarif_class_id":1876,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1629,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}}],"set_id":"203_283","id":null}}},"200":{"all-world-rouming/sms":{"200":{"part":"all-world-rouming/sms","tarif_class_id":200,"call_ids":[],"price_value":0.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1771,"service_category_name":"_sctcg_all_world_sms_incoming","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1546,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_volume":0}}],"set_id":"200","id":null}},"own-country-rouming/sms":{"200":{"part":"own-country-rouming/sms","tarif_class_id":200,"call_ids":[4484,4500,4528,4546,4554,4562,4567,4492,4496,4505,4510,4514,4523,4532,4541,4572,4577,4581,4585,4590,4594,4599,4603,4607,4480,4550,4519,4537,4558],"price_value":42.8,"call_id_count":"29.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1760,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4484,4500,4528,4546,4554,4562,4567],"call_id_count":7,"price_formula_id":1535,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4484,4500,4528,4546,4554,4562,4567],"call_id_count":7,"count_volume":7}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1761,"service_category_name":"_sctcg_own_home_regions_sms_to_own_home_regions","month":1,"call_ids":[4492,4496,4505,4510,4514,4523,4532,4541,4572,4577,4581,4585,4590,4594,4599,4603,4607],"call_id_count":17,"price_formula_id":1536,"price_value":32.3,"all_stat":{"month":1,"call_ids":[4492,4496,4505,4510,4514,4523,4532,4541,4572,4577,4581,4585,4590,4594,4599,4603,4607],"call_id_count":17,"count_volume":17}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1762,"service_category_name":"_sctcg_own_home_regions_sms_to_own_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1537,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_volume":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1763,"service_category_name":"_sctcg_own_home_regions_sms_to_not_own_country","month":1,"call_ids":[4480,4550],"call_id_count":2,"price_formula_id":1538,"price_value":10.5,"all_stat":{"month":1,"call_ids":[4480,4550],"call_id_count":2,"count_volume":2}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1770,"service_category_name":"own_country_sms_incoming","month":1,"call_ids":[4519,4537,4558],"call_id_count":3,"price_formula_id":1545,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4519,4537,4558],"call_id_count":3,"count_volume":3}}],"set_id":"200","id":null}},"own-country-rouming/mms":{"200":{"part":"own-country-rouming/mms","tarif_class_id":200,"call_ids":[4485,4488,4489,4506,4507,4516,4520,4525,4534,4543,4551,4555,4568,4569,4573,4578,4587,4591,4604,4608,4609,4481,4497,4501,4502,4515,4524,4529,4533,4538,4542,4559,4563,4564,4574,4586,4595,4596,4600,4533,4533],"price_value":123.5,"call_id_count":"41.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1747,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4485,4488,4489,4506,4507,4516,4520,4525,4534,4543,4551,4555,4568,4569,4573,4578,4587,4591,4604,4608,4609],"call_id_count":21,"price_formula_id":1522,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4485,4488,4489,4506,4507,4516,4520,4525,4534,4543,4551,4555,4568,4569,4573,4578,4587,4591,4604,4608,4609],"call_id_count":21,"count_volume":21}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1748,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4481,4497,4501,4502,4515,4524,4529,4533,4538,4542,4559,4563,4564,4574,4586,4595,4596,4600],"call_id_count":18,"price_formula_id":1523,"price_value":117.0,"all_stat":{"month":1,"call_ids":[4481,4497,4501,4502,4515,4524,4529,4533,4538,4542,4559,4563,4564,4574,4586,4595,4596,4600],"call_id_count":18,"count_volume":18}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1774,"service_category_name":"_sctcg_own_home_regions_mms_to_own_country_own_operator","month":1,"call_ids":[4533],"call_id_count":1,"price_formula_id":1549,"price_value":3.25,"all_stat":{"month":1,"call_ids":[4533],"call_id_count":1,"count_volume":1}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1775,"service_category_name":"_sctcg_own_home_regions_mms_to_own_country_own_operator","month":1,"call_ids":[4533],"call_id_count":1,"price_formula_id":1550,"price_value":3.25,"all_stat":{"month":1,"call_ids":[4533],"call_id_count":1,"count_volume":1}}],"set_id":"200","id":null}},"all-world-rouming/mms":{"200":{"part":"all-world-rouming/mms","tarif_class_id":200,"call_ids":[4511,4547,4493,4582],"price_value":13.0,"call_id_count":"4.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1749,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4511,4547],"call_id_count":2,"price_formula_id":1524,"price_value":0.0,"all_stat":{"month":1,"call_ids":[4511,4547],"call_id_count":2,"count_volume":2}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1750,"service_category_name":"_sctcg_own_home_regions_sms_incoming","month":1,"call_ids":[4493,4582],"call_id_count":2,"price_formula_id":1525,"price_value":13.0,"all_stat":{"month":1,"call_ids":[4493,4582],"call_id_count":2,"count_volume":2}}],"set_id":"200","id":null}},"own-country-rouming/mobile-connection":{"200":{"part":"own-country-rouming/mobile-connection","tarif_class_id":200,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4570,4575,4579,4583,4597,4601,4610],"price_value":11107.8,"call_id_count":"24.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1764,"service_category_name":"_sctcg_own_home_regions_internet","month":1,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4570,4575,4579,4583,4597,4601,4610],"call_id_count":24,"price_formula_id":1539,"price_value":11107.8,"all_stat":{"month":1,"call_ids":[4486,4490,4494,4498,4503,4508,4512,4517,4521,4530,4535,4539,4544,4548,4552,4556,4560,4570,4575,4579,4583,4597,4601,4610],"call_id_count":24,"sum_volume":1122}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1765,"service_category_name":"_sctcg_own_home_regions_wap_internet","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1540,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_volume":0}}],"set_id":"200","id":null}},"own-country-rouming/calls":{"200":{"part":"own-country-rouming/calls","tarif_class_id":200,"call_ids":[4522,4561,4495,4557,4576,4602,4584,4487,4504,4513,4518,4589,4598,4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"price_value":482.0,"call_id_count":"23.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1758,"service_category_name":"_sctcg_own_home_regions_calls_europe","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1533,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1755,"service_category_name":"_sctcg_own_home_regions_calls_to_own_country_to_own_operator","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1530,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1756,"service_category_name":"_sctcg_own_home_regions_calls_to_own_country_to_not_own_operator","month":1,"call_ids":[4522,4561],"call_id_count":2,"price_formula_id":1531,"price_value":384,"all_stat":{"month":1,"call_ids":[4522,4561],"call_id_count":2,"sum_duration_minute":48}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1769,"service_category_name":"own_country_calls_other_countries","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1544,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1759,"service_category_name":"_sctcg_own_home_regions_calls_other_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1534,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1752,"service_category_name":"_sctcg_own_home_regions_calls_to_own_home_regions_own_operator","month":1,"call_ids":[4495,4557,4576,4602],"call_id_count":4,"price_formula_id":1527,"price_value":0,"all_stat":{"month":1,"call_ids":[4495,4557,4576,4602],"call_id_count":4,"sum_duration_minute":52}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1753,"service_category_name":"_sctcg_own_home_regions_calls_to_own_home_regions_to_fixed_line","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1528,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1766,"service_category_name":"_sctcg_own_country_calls_to_own_country_not_own_operator","month":1,"call_ids":[4584],"call_id_count":1,"price_formula_id":1541,"price_value":98,"all_stat":{"month":1,"call_ids":[4584],"call_id_count":1,"sum_duration_minute":7}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1757,"service_category_name":"_sctcg_own_home_regions_calls_sic_country","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1532,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1768,"service_category_name":"own_country_calls_europe","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1543,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1754,"service_category_name":"_sctcg_own_home_regions_calls_to_own_home_regions_to_other_operator","month":1,"call_ids":[4487,4504,4513,4518,4589,4598],"call_id_count":6,"price_formula_id":1529,"price_value":0,"all_stat":{"month":1,"call_ids":[4487,4504,4513,4518,4589,4598],"call_id_count":6,"sum_duration_minute":43}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1767,"service_category_name":"own_country_calls_sic_countries","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1542,"price_value":0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"sum_duration_minute":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1751,"service_category_name":"_sctcg_own_home_regions_calls_incoming","month":1,"call_ids":[4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"call_id_count":10,"price_formula_id":1526,"price_value":0,"all_stat":{"month":1,"call_ids":[4479,4483,4491,4499,4509,4531,4545,4549,4566,4593],"call_id_count":10,"sum_duration_minute":138}}],"set_id":"200","id":null}},"periodic":{"200":{"part":"periodic","tarif_class_id":200,"call_ids":[],"price_value":34.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1746,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1521,"price_value":0.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}},{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1773,"service_category_name":"periodic_monthly_fee","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1548,"price_value":34.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}}],"set_id":"200","id":null}},"onetime":{"200":{"part":"onetime","tarif_class_id":200,"call_ids":[],"price_value":34.0,"call_id_count":"0.0","price_values":[{"tarif_class_id":200,"service_category_group_id":-1,"service_category_tarif_class_id":1772,"service_category_name":"one_time_tarif_switch_on","month":-1,"call_ids":[],"call_id_count":0,"price_formula_id":1547,"price_value":34.0,"all_stat":{"month":-1,"call_ids":[],"call_id_count":0,"count_time":0}}],"set_id":"200","id":null}}}},"tarif_results_ord":{}}}}'
    output = output.gsub(/:/, '=>'); output = output.gsub(/null/, 'nil');
    output = eval(output)
    @operator = 1030
    @orp = ServiceHelper::OptimizationResultPresenter.new(@operator, {}, output)
  end
  
  it 'must exists' do
    ServiceHelper::OptimizationResultPresenter.must_be :==, ServiceHelper::OptimizationResultPresenter
  end
  
  describe 'init_results' do
    it 'must init @results' do
      @orp.results.keys.must_be :==, ["1030"], @orp.results.keys
    end
  end

  describe 'tarif_sets' do
    it 'must return' do
      @orp.tarif_sets['203']["own-country-rouming/calls"].keys.must_be :==, ["203_283", "203"]
      @orp.tarif_sets['203']["own-country-rouming/calls"]['203'].must_be :==, [203]
      @orp.tarif_sets['203']["own-country-rouming/calls"]['203_283'].must_be :==, [203, 283]
    end
  end

  describe 'tarif_results' do
    it 'must return' do
      @orp.tarif_results.keys.must_be :==, ["283", "203", "203_283", "200"] 
      @orp.tarif_results["203_283"].keys.must_be :==, ["own-country-rouming/mobile-connection", "own-country-rouming/calls", "periodic", "onetime"]
      @orp.tarif_results["203_283"]["onetime"].keys.must_be :==, ["203"]
      @orp.tarif_results['200']["own-country-rouming/calls"]['200'].keys.must_be :==, ["part", "tarif_class_id", "call_ids", "price_value", "call_id_count", "price_values", "set_id", "id"]
    end
  end

  describe 'service_sets_array' do
    it 'must return' do
      @orp.service_sets_array[0].keys.must_be :==, ["service_sets_id", "service_set_price"]
    end
  end

  describe 'tarif_results_details_array' do
    it 'must return' do
#      @orp.tarif_results_details_array('200', '200')[0].keys.must_be :==, ["tarif_class_id", "service_category_group_id", "service_category_tarif_class_id", "service_category_name", "call_ids", "call_id_count", "price_formula_id", "price_value", "all_stat", "period count price"]
    end
  end

  describe 'tarif_results_array' do
    it 'must return' do
      @orp.tarif_results_array('200')[0].keys.must_be :==, ["part", "tarif_class_id", "call_ids", "price_value", "call_id_count", "price_values", "set_id", "id"]
    end
  end

end

